---
name: useCollectionQuery
menu: Hooks
route: /hooks/use-collection-query
---

import { Playground } from "docz";
import {
  ApolloClient,
  InMemoryCache,
  useQuery,
  ApolloProvider,
} from "@apollo/client";
import { useEffect, useState } from "react";
import { List } from "@jobber/components/List";
import { Card } from "@jobber/components/Card";
import { Button } from "@jobber/components/Button";
import { Spinner } from "@jobber/components/Spinner";
import { useCollectionQuery } from "@jobber/hooks";
import { ListQueryType, client } from "./mdxUtils";
import gql from "graphql-tag";

# UseCollectionQuery

`useCollectionQuery` is a generalized hook that that fetches a collection of
data. For use with any lists populated by graphQL collections.

```tsx
import { useCollectionQuery } from "@jobber/hooks";
```

<Playground>
  {() => {
    console.log("i got in here");
    const [items, setItems] = useState([]);
    const LIST_QUERY = gql`
      query ListQuery($cursor: String) {
        allPlanets(first: 4, after: $cursor) {
          pageInfo {
            hasNextPage
            endCursor
          }
          edges {
            node {
              name
            }
            cursor
          }
          totalCount
        }
      }
    `;
    const {
      data,
      error,
      refresh,
      nextPage,
      loadingRefresh,
      loadingNextPage,
      loadingInitialContent,
    } = useCollectionQuery({
      query: LIST_QUERY,
      queryOptions: {
        fetchPolicy: "network-only",
        nextFetchPolicy: "network-only",
        client: client,
      },
      getCollectionByPath(items) {
        return items;
      },
    });
    console.log("data", data);
    const styles = {
      spinners: {
        display: "flex",
      },
      loadingIndicator: {
        flex: 1,
        padding: 20,
      },
    };
    return (
      <>
        <div style={styles.spinners}>
          <div style={styles.loadingIndicator}>
            <h4>Initial Loading Indicator</h4>
            {loadingInitialContent && <Spinner />}
          </div>
          <div style={styles.loadingIndicator}>
            <h4>Refreshing Indicator</h4>
            {loadingRefresh && <Spinner />}
          </div>
          <div style={styles.loadingIndicator}>
            <h4>Fetching More Indicator</h4>
            {loadingNextPage && <Spinner />}
          </div>
        </div>
        <div>
          <List items={items || []} />
        </div>
        <div>
          <Button
            label={"Fetch More"}
            onClick={() => {
              alert("hi");
            }}
          />
          <Button
            label={"Reload"}
            onClick={() => {
              refresh();
            }}
          />
        </div>
      </>
    );
  }}
</Playground>
